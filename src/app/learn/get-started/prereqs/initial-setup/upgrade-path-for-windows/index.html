<stache
  pageTitle="Node.js Upgrade Path for Windows"
  navTitle="Upgrade path">

  <stache-page-summary>
    <p>
      Follow these instructions for an easy transition from Node.js 6 to Node.js 10.
    </p>
  </stache-page-summary>

  <stache-page-anchor>
    Upgrade to Node.js 10.15.1 and npm 6.4.1 on Windows
  </stache-page-anchor>
  
  <ol>
    <li>
      Close Visual Studio 2017, Visual Studio Code, and any other tool that uses Node.js for a runtime, compilation, script execution, etc.
    </li>
    <li>
      Download the Windows Installer Package at <a href="https://nodejs.org/dist/v10.15.1/node-v10.15.1-x64.msi">https://nodejs.org/dist/v10.15.1/node-v10.15.1-x64.msi</a>.
    </li>
    <li>
      Run the downloaded file to install Node.js 10.15.1 and npm 6.4.1.
      <ol>
        <li>
          On the welcome page of the Node.js Setup Wizard, select <strong>Next</strong>.
        </li>
        <li>
          On the licence agreement page, select <strong>I accept the terms in the License Agreement</strong> and then select <strong>Next</strong>.
        </li>
        <li>
          On the destination folder page, select <strong>Next</strong> to accept the default location.
        </li>
        <li>
          On the custom setup page, select <strong>Next</strong> to accept the defaults.
        </li>
        <li>
          To install Node.js 10.15.1 and npm 6.4.1, select <strong>Install</strong>.
        </li>
        <li>
          After the installation completes, select <strong>Finish</strong> to close the setup wizard.
        </li>
      </ol>
    </li>
    <li>
      After the installation, reboot your machine.
    </li>
    <li>
      Open PowerShell by selecting <strong>Run as administrator</strong> and verify the versions of Node.js and npm. When you run <stache-code>node -v</stache-code> and <stache-code>npm -v</stache-code>, you should get <stache-code>v10.15.1</stache-code> and <stache-code>6.4.1</stache-code> respectively.
    </li>
    <li>
      In the same Terminal, run <stache-code>npm install --global --production windows-build-tools</stache-code>.
    </li>
    <li>
      After the command runs, reboot your machine again.
    </li>
    <li>
      After the machine reboots, run <stache-code>rimraf node_modules</stache-code> and then <stache-code>npm install</stache-code> on your projects. When finished, you may notice a warning about vulnerabilities. This is expected.
    </li>
  </ol>

  <stache-page-anchor>
    Upgrade to npm 6.5.0 on Windows to match Build Pipeline
  </stache-page-anchor>

  <sky-alert alertType="warning">
    Follow these steps <strong><em>after</em></strong> updating to Node.js 10.15.1.
  </sky-alert>
  <ol>
    <li>
      Open PowerShell by selecting <strong>Run as administrator</strong>.
    </li>
    <li>
      Run <stache-code>Set-ExecutionPolicy Unrestricted -Scope CurrentUser -Force</stache-code>.
    </li>
    <li>
      Run <stache-code>npm install --global --production npm-windows-upgrade</stache-code>.
    </li>
    <li>
      Run <stache-code>npm-windows-upgrade --npm-version 6.5.0</stache-code>.
    </li>
    <li>
      Reboot your machine again.
    </li>
    <li>
      Open PowerShell by selecting <strong>Run as administrator</strong> and verify the versions of Node.js and npm. When you run <stache-code>node -v</stache-code> and <stache-code>npm -v</stache-code>, you should get <stache-code>v10.15.1</stache-code> and <stache-code>6.5.0</stache-code> respectively.
    </li>
  </ol>

</stache>
